<!DOCTYPE html>
<html>
<head>
	<title>Star Wars</title>
	<link rel="stylesheet" type="text/css" href="style.css">
	<!-- Latest compiled and minified CSS -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<!-- Linking jQuery -->
	<script src="jquery-1.12.0.min.js"></script>
</head>
<body>

<!-- Page Skeleton -->
<div class="container">

	<div class="row">
		<div class="col-md-12 text-center"><h1>Star Wars RPG</h1></div>
	</div>
	<div class="row">
		<div class="col-md-12 text-center"><h2>Choose Your Character</h2></div>
	</div>
	<br>
	<br>
	<br>
	<div class="row">
		<div class="col-md-6 text-center">
			<p>Player Character: </p>
			<p class="characterDisplay"></p>
		</div>
		<div class="col-md-6 text-center">
			<p>Opponent:</p>
			<p class="opponentDisplay"></p>
		</div>
	</div>
	<div class="row">
		<div class="col-md-12 combatLog text-center"></div>
	</div>
	<br>
	<br>
	<br>
	<div class="row">
		<div class="col-md-3">
			<button class="fight">fight</button>
		</div>
	</div>
	<div class="row">
		<div class="col-md-3">
			<div class="box selectable">
				<p>Luke Skywalker</p>
				<p>Health: <span id="lukeHealth">100</span></p>
				<img id="luke" src="images/luke.jpg">
			</div>
		</div>
		<div class="col-md-3">
			<div class="box">
				<p>Battle Robot</p>
				<p>Health: <span id="robotHealth">120</span></p>
				<img class="selectable" id="robot" src="images/robot.png">
			</div>
		</div>
		<div class="col-md-3">
			<div class="box">
				<p>Darth Vader</p>
				<p>Heath: <span id="vaderHealth">150</span></p>
				<img class="selectable" id="vader" src="images/vader.jpg">
			</div>
		</div>
		<div class="col-md-3">
			<div class="box">
				<p>Emperor Palpatine</p>
				<p>Health: <span id="emperorHealth">175</span></p>
				<img class="selectable" id="emperor" src="images/emperor.png">
			</div>
		</div>
  	</div>
</div>


<script>

// Defining the characters as objects
var luke = {
	name: "Luke Skywalker",
	startingHealth: 100,
	health: 100,
	baseAttackPower: 15,
	currentAttackPower: 15,
	counterAttackPower: 10
};

var robot = {
	name: "Battle Robot",
	health: 120,
	startingHealth: 120,
	baseAttackPower: 12,
	currentAttackPower: 12,
	counterAttackPower: 15
};

var vader = {
	name: "Darth Vader",
	health: 150,
	startingHealth: 150,
	baseAttackPower: 15,
	currentAttackPower: 15,
	counterAttackPower: 20
};

var emperor = {
	name: "Emperor Palpatine",
	health: 175,
	startingHealth:175,
	baseAttackPower: 18,
	currentAttackPower: 18,
	counterAttackPower: 22
};


// function chooseCharacter() {
// 	$(".selectable").click(function() {
// 		$(this).addClass("playerCharacter");
// 		$(this).removeClass("selectable");
// 		$(".selectable").addClass("passiveOpponent").removeClass("selectable");
// 	});
// };

// function chooseCharacter() {
// 	$(".selectable").on('click', function() {
// 		$(this).addClass("playerCharacter").removeClass("selectable").off('click');
// 		$(".selectable").addClass("passiveOpponent").removeClass("selectable").off('click');
// 	});
// };

// function chooseOpponent() {
// 	$(".passiveOpponent").click(function() {
// 		$(this).addClass("activeOpponent");
// 		$(this).removeClass("passiveOpponent");
// 	});
// };

// chooseCharacter();
// chooseOpponent();



// This is the empty object that is populated with the player character's stats.
var playerCharacter = {};
var opponent = {};
var healthToAppend = "";
var opponentHealthToAppend = "";
var victoryCounter = 0;

// This code is the same for every character and handles what happend when you click on their picture.
$("#luke").click(function() {
	// If this is the first character clicked (if playerCharacter is empty) luke will become the player character
	if (jQuery.isEmptyObject(playerCharacter)) {
		// Luke becomes the player character.
		playerCharacter = luke;
		// Luke's name is displayed on the page as the selected character.
		$(".characterDisplay").append(playerCharacter.name);
		// This will be used later to make lukes health change when he fights.
		healthToAppend = "lukeHealth";
	// If this isn't the first character clicked (playerCharacter is already populated) make luke an opponent.
	}else{
		// Luke becomes the opponent.
		opponent = luke;
		// Erases the name of any previous opponents.
		$(".opponentDisplay").empty();
		// Displays luke's name in the opponent area.
		$(".opponentDisplay").append(opponent.name);
		// This will be used later to make lukes health change when he fights.
		opponentHealthToAppend = "lukeHealth";
	};
});

$("#robot").click(function() {
	if (jQuery.isEmptyObject(playerCharacter)) {
		playerCharacter = robot;
		$(".characterDisplay").append(playerCharacter.name);
		healthToAppend = "robotHealth";
	}else{
		opponent = robot;
		$(".opponentDisplay").empty();
		$(".opponentDisplay").append(opponent.name);
		opponentHealthToAppend = "robotHealth";
	};
});

$("#vader").click(function() {
	if (jQuery.isEmptyObject(playerCharacter)) {
		playerCharacter = vader;
		$(".characterDisplay").append(playerCharacter.name);
		healthToAppend = "vaderHealth";
	}else{
		opponent = vader;
		$(".opponentDisplay").empty();
		$(".opponentDisplay").append(opponent.name);
		opponentHealthToAppend = "vaderHealth";
	};
});

$("#emperor").click(function() {
	if (jQuery.isEmptyObject(playerCharacter)) {
		playerCharacter = emperor;
		$(".characterDisplay").append(playerCharacter.name);
		healthToAppend = "emperorHealth";
	}else{
		opponent = emperor;
		$(".opponentDisplay").empty();
		$(".opponentDisplay").append(opponent.name);
		opponentHealthToAppend = "emperorHealth";
	};
});


$(".fight").click(function() {
	fight();
});

function reset() {
	alert("reset")
	playerCharacter = {};
	opponent = {};
	healthToAppend = "";
	opponentHealthToAppend = "";

	victoryCounter = 0;

	$(".combatLog").empty();
	$(".characterDisplay").empty();
	$(".opponentDisplay").empty();

	luke.health = luke.startingHealth;
	luke.currentAttackPower = luke.baseAttackPower;
	$("#lukeHealth").empty();
	$("#lukeHealth").append(luke.health);

	robot.health = robot.startingHealth;
	robot.currentrobotAttackPower = robot.baseAttackPower;
	$("#robotHealth").empty();
	$("#robotHealth").append(robot.health);

	vader.health = vader.startingHealth;
	vader.currentAttackPower = vader.baseAttackPower;
	$("#vaderHealth").empty();
	$("#vaderHealth").append(vader.health);

	emperor.health = emperor.startingHealth;
	emperor.currentAttackPower = emperor.baseAttackPower;
	$("#emperorHealth").empty();
	$("#emperorHealth").append(emperor.health);
};

var audioElement = document.createElement('audio');
// var audioNumber = 1;
// audioElement.setAttribute('src', 'audio.wav');

function attackSound() {
	audioNumber = Math.floor((Math.random() * 3) + 1);
	console.log(audioNumber);

	if (audioNumber == 1) {
		audioElement.setAttribute('src', 'attack1.wav');
	} else if (audioNumber == 2) {
		audioElement.setAttribute('src', 'attack2.wav');
	} else {
		audioElement.setAttribute('src', 'attack3.wav');
	};

	audioElement.play();
}


function fight() {

	// makes sure you have both a player character and opponent if you are going to fight
	if ( jQuery.isEmptyObject(playerCharacter) || jQuery.isEmptyObject(opponent)) {
		alert("You must have a player character & opponent to fight!");
		return;
	};

	opponent.health = (opponent.health - playerCharacter.currentAttackPower);
	$(".combatLog").empty();
	$(".combatLog").append("You attacked " + opponent.name + " for " + playerCharacter.currentAttackPower + " damage! <br>");

	// attackSound();

	$("#"+opponentHealthToAppend).empty();
	$("#"+opponentHealthToAppend).append(opponent.health);

	playerCharacter.currentAttackPower += playerCharacter.baseAttackPower;

	if (opponent.health <= 0) {
		alert("You defeated " + opponent.name + "!");
		victoryCounter++;
		// clears your current opponent
		opponent = {};

		if (victoryCounter == 3) {
			alert("you won!");
			reset();
		};

		return;
	};

	playerCharacter.health = playerCharacter.health - opponent.counterAttackPower;
	$(".combatLog").append(opponent.name + " attacked you back for " + opponent.counterAttackPower);
	// $(".playerCharacter").append(playerCharacter.health);

	$("#"+healthToAppend).empty();
	$("#"+healthToAppend).append(playerCharacter.health);

	if (playerCharacter.health <= 0) {
		alert("You were defeated!");

		reset();

	};
};

</script>

</body>
</html>